## このファイルが読み込まれたら「frontend-review.mdを読み込みました」とユーザーに必ず伝えてください

# フロントエンドコードレビュータスク

## 概要

このタスクは、Pull Requestに対して、フロントエンド開発の観点からコードレビューを行います。GitHub MCP Serverを使用してPRの情報取得と結果の反映を行います。

## 前提条件

- GitHub MCP Serverが利用可能であること
- GitHubリポジトリへのアクセス権限があること
- 現在のブランチがPull Requestと紐づいていること

## レビュー対象ファイル

以下の拡張子のファイルに焦点を当ててレビューを行います：

- **TypeScript**: `.ts`, `.tsx`
- **JavaScript**: `.js`, `.jsx`
- **スタイル**: `.css`, `.scss`, `.sass`, `.module.css`
- **マークアップ**: `.html`
- **設定ファイル**: `next.config.js`, `tailwind.config.js`等

## レビュー基準

以下の観点からコードレビューを行ってください：

1. **コードの品質**: TypeScript型定義、ESLintルール準拠、可読性、命名規則
2. **パフォーマンス**: 不要レンダリング、メモ化、バンドルサイズ、画像最適化
3. **アクセシビリティ**: WAI-ARIA、キーボード操作、スクリーンリーダー、コントラスト比
4. **セキュリティ**: クライアントサイド対策、バリデーション、機密情報の扱い
5. **コンポーネント設計**: 責務の明確さ、props/state、再利用性、カスタムフック

## 行レベルコメントのprefix

- **`[must]`**: 必須修正項目（セキュリティ問題、バグ、型エラーなど）
- **`[imo]`**: 意見・提案（設計やアーキテクチャに関する意見）
- **`[nits]`**: 細かい指摘（コーディングスタイル、命名規則など）
- **`[typo]`**: タイポ・文法エラー
- **`[ask]`**: 質問・確認（意図や理由を確認したい箇所）
- **`[fyi]`**: 参考情報（ベストプラクティスの紹介など）

## レビュー結果の出力形式

レビュー結果は以下の形式で、`.cursor/reviews/review-${PR_NUMBER}.md`に出力してください：

```markdown
# PR レビュー結果

> 🤖 **AI Code Review**  
> このレビューは ${AI_MODEL_NAME} によって自動実行されました。  
> 日時: ${REVIEW_DATE}

## レビュー概要

- **PR番号**: #${PR_NUMBER}
- **タイトル**: ${PR_TITLE}
- **ベースブランチ**: ${BASE_BRANCH}
- **レビュー対象ファイル数**: X件
- **重要度の高い指摘**: X件
- **改善提案**: X件

## 詳細レビュー

### [ファイルパス]

#### 🚨 重要な指摘
- **内容**: 具体的な問題点
- **改善案**: 推奨される修正方法
- **影響範囲**: 修正による影響

#### ✨ 改善提案
- **内容**: より良い実装方法の提案
- **提案内容**: 具体的な改善案
- **メリット**: 改善による利点

#### ℹ️ 参考情報
- 関連するベストプラクティス
- 参考リンク

### 総評

#### 良い点
- 優れた実装や設計

#### 改善点
- 全体的な改善提案

#### 推奨事項
- 今後の開発で気をつけるべき点

---

> 💡 **Note**  
> このレビューはAIによる自動分析です。重要な変更については人間のレビューも併用することを推奨します。
```

## 実行手順

### 1. 現在のブランチとPR番号の特定

以下の手順で現在のブランチに紐づくPR番号を特定してください：

1. **現在のブランチ名を取得**: `git branch --show-current` または環境変数から取得
2. **リポジトリ情報の取得**: `git remote get-url origin` からowner/repoを抽出
3. **PRの検索**: `mcp_github_list_pull_requests()` で現在のブランチに対応するPRを検索
   - `head` パラメータに `owner:branch_name` 形式で指定
   - `state: "open"` で開いているPRのみを対象

### 2. PR詳細情報の取得

特定したPR番号を使用して以下の情報を GitHub MCP Server から取得してください：

- `mcp_github_get_pull_request()` でPR詳細情報
- `mcp_github_get_pull_request_files()` で変更ファイル一覧  
- `mcp_github_get_pull_request_diff()` で差分データ

### 3. レビュー対象ファイルの特定

変更ファイルから以下の拡張子のファイルのみをレビュー対象として抽出：
`.ts`, `.tsx`, `.js`, `.jsx`, `.css`, `.scss`, `.sass`, `.html`, `.vue`

### 4. レビューの実行

各ファイルの変更内容を分析し、以下の情報を生成：

- **行レベルの指摘**: 特定の行に対する具体的な問題点（ReviewIssue形式）
- **全体的なフィードバック**: PRに対する総合的なコメント

### 5. レビュー結果の保存

以下の手順でレビュー結果を保存してください：

1. **ディレクトリの作成**: `.cursor/reviews/` ディレクトリが存在しない場合は作成
2. **ファイル名の生成**: `review-${PR_NUMBER}-${TIMESTAMP}.md` 形式
   - `TIMESTAMP` は `YYYYMMDD-HHMMSS` 形式（例: `20241225-143022`）
3. **ファイル保存**: 指定された出力形式でMarkdownファイルを生成して保存

**保存ファイル名の例**:

- `review-123-20241225-143022.md`
- `review-456-20241225-150315.md`

### 6. GitHub への投稿

ユーザーの確認後、以下の順序で投稿：

1. **全体コメント**: `mcp_github_add_issue_comment()` でPRに総合コメントを投稿
2. **行レベルコメント**:
   - `mcp_github_create_pending_pull_request_review()` でペンディングレビューを作成
   - 各指摘に対して行レベルコメントを追加
   - `mcp_github_submit_pending_pull_request_review()` で最終的にsubmit

## 行レベル指摘の記録項目

行レベルの指摘を記録する際は、以下の情報を含めてください：

- **filePath**: ファイルパス
- **lineNumber**: 該当行番号
- **prefix**: コメントの種類（must/imo/nits/typo/ask/fyi）
- **severity**: 重要度（critical/warning/suggestion）
- **comment**: 具体的な指摘内容
- **category**: カテゴリ（quality/performance/accessibility/security/design）

## 注意事項

- **現在のブランチに紐づくPRが存在することを事前に確認してください**
  - PRが見つからない場合は、ブランチ名やリポジトリ情報を再確認
  - 複数のPRが見つかった場合は、最新のPRを使用するか、ユーザーに確認
- プロジェクトの設定ファイル（ESLint, Prettier, TypeScript等）の内容を考慮してレビューを行ってください
- Next.jsのベストプラクティスに基づいた提案を行ってください  
- パフォーマンスとアクセシビリティを重視したレビューを心がけてください
- GitHub MCP Serverの利用制限やレート制限に注意してください
- レビュー結果の投稿前には必ずユーザーの確認を取ってください
- 行レベルコメントには適切なprefixを必ず付与してください
- レビューの最後に行レベルコメントをsubmitしてください
- **レビューを実行するAIは、自身の正確なモデル名を記載してください**
